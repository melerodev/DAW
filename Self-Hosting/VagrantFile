Vagrant.configure("2") do |config|
  config.vm.box = "debian/bullseye64"

  # Máquina maestro
  config.vm.define "selfHosting" do |selfHosting|
    selfHosting.vm.hostname = "selfHosting.sistema.test"
    selfHosting.vm.network "public_network"
    selfHosting.vm.provider "virtualbox" do |vb|
      vb.name = "selfHosting"
    end
    selfHosting.vm.provision "shell", inline: <<-SHELL
      echo "-------------------INSTALACIÓN DE PAQUETES-------------------"
      apt-get update -y
      apt-get install apache2 -y
      echo "-------------------INSTALACIÓN DE PAQUETES-------------------"

      echo "-------------------CONFIGURACIÓN DE APACHE-------------------"
      cp /vagrant/config/apache/000-default.conf /etc/apache2/sites-available/000-default.conf
      cp -r /vagrant/config/web/* /var/www/html/
      chmod -R 755 /var/www/html/
      sudo apt install apache2-utils -y
      cp /vagrant/config/apache/.htpasswd /etc/apache2/.htpasswd

      sudo systemctl restart apache2
      systemctl status apache2

      echo "-------------------CONFIGURACIÓN DE APACHE-------------------"
    SHELL
  end
end